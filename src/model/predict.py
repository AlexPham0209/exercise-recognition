import os
import keras
import numpy as np
import tensorflow as tf

MODEL_PATH = "models"

arr = np.array([
-0.255,-0.000,-0.004,0.000,0.000,0.000,
-0.252,-0.000,-0.003,0.000,0.000,0.000,
-0.253,0.001,-0.004,0.000,0.000,0.000,
-0.253,0.001,-0.006,0.000,0.000,0.000,
-0.254,0.001,-0.006,0.000,0.000,0.000,
-0.252,0.001,-0.006,0.000,0.000,0.000,
-0.252,0.001,-0.007,0.000,0.000,0.000,
-0.255,0.000,-0.007,0.000,0.000,0.000,
-0.257,0.000,-0.006,0.000,0.000,0.000,
-0.255,0.000,-0.005,0.000,0.000,0.000,
-0.253,0.001,-0.004,0.000,0.000,0.000,
-0.255,0.000,-0.005,0.000,0.000,0.000,
-0.255,0.000,-0.005,0.000,0.000,0.000,
-0.254,0.001,-0.005,0.000,0.000,0.000,
-0.253,0.001,-0.006,0.000,0.000,0.000,
-0.254,0.001,-0.006,0.000,0.000,0.000,
-0.251,0.001,-0.005,0.000,0.000,0.000,
-0.253,0.001,-0.005,0.000,0.000,0.000,
-0.256,0.000,-0.006,0.000,0.000,0.000,
-0.256,0.001,-0.005,0.000,0.000,0.000,
-0.253,0.002,-0.006,0.000,0.000,0.000,
-0.253,0.001,-0.007,0.000,0.000,0.000,
-0.255,0.000,-0.004,0.000,0.000,0.000,
-0.255,-0.001,-0.004,0.000,0.000,0.000,
-0.256,0.000,-0.005,0.000,0.000,0.000,
-0.252,0.001,-0.005,0.000,0.000,0.000,
-0.250,0.001,-0.003,0.000,0.000,0.000,
-0.251,0.001,-0.004,0.000,0.000,0.000,
-0.255,0.001,-0.006,0.000,0.000,0.000,
-0.259,0.000,-0.007,0.000,0.000,0.000,
-0.259,0.000,-0.007,0.000,0.000,0.000,
-0.255,0.000,-0.005,0.000,0.000,0.000,
-0.250,0.001,-0.004,0.000,0.000,0.000,
-0.251,0.003,-0.006,0.000,0.000,0.000,
-0.254,0.002,-0.007,0.000,0.000,0.000,
-0.255,0.001,-0.006,0.000,0.000,0.000,
-0.255,-0.000,-0.006,0.000,0.000,0.000,
-0.256,-0.000,-0.005,0.000,0.000,0.000,
-0.256,-0.000,-0.005,0.000,0.000,0.000,
-0.254,0.000,-0.003,0.000,0.000,0.000,
-0.251,0.001,-0.004,0.000,0.000,0.000,
-0.254,0.001,-0.004,0.000,0.000,0.000,
-0.255,0.001,-0.006,0.000,0.000,0.000,
-0.256,0.001,-0.005,0.000,0.000,0.000,
-0.255,0.001,-0.006,0.000,0.000,0.000,
-0.253,0.002,-0.006,0.000,0.000,0.000,
-0.251,0.002,-0.005,0.000,0.000,0.000,
-0.253,0.002,-0.005,0.000,0.000,0.000,
-0.255,0.001,-0.004,0.000,0.000,0.000,
-0.256,0.002,-0.006,0.000,0.000,0.000,
-0.255,0.002,-0.006,0.000,0.000,0.000,
-0.255,0.000,-0.004,0.000,0.000,0.000,
-0.255,0.000,-0.004,0.000,0.000,0.000,
-0.257,0.001,-0.004,0.000,0.000,0.000,
-0.259,0.001,-0.008,0.000,0.000,0.000,
-0.262,0.001,-0.007,0.000,0.000,0.000,
-0.259,0.002,-0.001,0.000,0.000,-0.000,
-0.257,0.003,-0.003,0.000,0.000,-0.000,
-0.252,0.006,-0.008,0.000,0.000,-0.000,
-0.250,0.006,-0.005,0.000,-0.000,-0.000,
-0.245,0.005,-0.001,0.000,-0.000,-0.000,
-0.247,0.006,-0.001,0.000,0.000,-0.000,
-0.252,0.006,-0.006,0.000,0.000,-0.000,
-0.255,0.004,-0.005,0.000,0.000,0.000,
-0.255,0.003,-0.003,0.000,0.000,0.000,
-0.254,0.003,-0.000,0.000,0.000,0.000,
-0.255,0.004,-0.001,0.000,0.000,0.000,
-0.257,0.003,-0.002,-0.000,0.000,0.000,
-0.254,0.004,-0.002,-0.000,0.000,0.000,
-0.250,0.005,-0.002,-0.000,-0.000,0.000,
-0.250,0.006,-0.004,-0.000,-0.000,0.000,
-0.254,0.007,-0.007,-0.000,-0.000,0.000,
-0.255,0.007,-0.007,-0.000,0.000,0.000,
-0.254,0.007,-0.008,-0.000,0.000,0.000,
-0.254,0.006,-0.007,-0.000,0.000,0.000,
-0.254,0.007,-0.006,-0.000,0.000,0.000,
-0.254,0.006,-0.004,0.000,-0.000,0.000,
-0.254,0.005,-0.005,0.000,0.000,0.000,
-0.256,0.004,-0.003,-0.000,0.000,0.000,
-0.254,0.004,-0.005,-0.000,0.000,0.000,
-0.253,0.004,-0.006,-0.000,0.000,0.000,
-0.253,0.004,-0.004,0.000,0.000,0.000,
-0.251,0.004,-0.005,0.000,0.000,0.000,
-0.255,0.004,-0.006,0.000,0.000,0.000,
-0.255,0.003,-0.007,0.000,0.000,0.000,
-0.257,0.004,-0.007,0.000,0.000,0.000,
-0.256,0.004,-0.006,0.000,0.000,0.000,
-0.254,0.005,-0.005,0.000,0.000,0.000,
-0.254,0.005,-0.005,0.000,0.000,0.000,
-0.254,0.005,-0.006,0.000,0.000,0.000,
-0.253,0.003,-0.005,0.000,0.000,0.000,
-0.255,0.003,-0.002,0.000,0.000,0.000,
-0.255,0.003,-0.005,0.000,0.000,0.000,
-0.254,0.004,-0.008,-0.000,0.000,0.000,
-0.254,0.004,-0.007,0.000,0.000,0.000,
-0.253,0.003,-0.004,0.000,0.000,0.000,
-0.253,0.003,-0.005,0.000,0.000,0.000,
-0.256,0.003,-0.006,0.000,0.000,0.000,
-0.256,0.003,-0.006,0.000,0.000,0.000,
-0.254,0.003,-0.004,0.000,0.000,0.000,
-0.253,0.004,-0.005,0.000,0.000,0.000,
-0.254,0.004,-0.005,0.000,0.000,0.000,
-0.253,0.004,-0.006,0.000,0.000,0.000,
-0.256,0.004,-0.006,0.000,0.000,0.000,
-0.254,0.004,-0.006,0.000,0.000,0.000,
-0.251,0.004,-0.007,0.000,0.000,0.000,
-0.253,0.004,-0.007,0.000,0.000,0.000,
-0.255,0.003,-0.006,0.000,0.000,0.000,
-0.255,0.004,-0.006,0.000,0.000,0.000,
-0.254,0.004,-0.007,0.000,0.000,0.000,
-0.254,0.003,-0.003,0.000,0.000,0.000,
-0.254,0.002,-0.002,0.000,0.000,0.000,
-0.255,0.003,-0.004,0.000,0.000,0.000,
-0.253,0.004,-0.007,0.000,0.000,0.000,
-0.254,0.004,-0.005,0.000,0.000,0.000,
-0.253,0.004,-0.004,0.000,0.000,0.000,
-0.254,0.004,-0.008,0.000,0.000,0.000,
-0.255,0.004,-0.007,0.000,0.000,0.000,
-0.253,0.004,-0.005,0.000,0.000,0.000,
-0.253,0.004,-0.004,0.000,0.000,0.000,
-0.253,0.004,-0.006,0.000,0.000,0.000,
-0.255,0.003,-0.003,0.000,0.000,0.000,
-0.257,0.002,-0.005,0.000,0.000,0.000,
-0.256,0.003,-0.006,0.000,0.000,0.000,
-0.254,0.003,-0.004,0.000,0.000,0.000,
-0.252,0.003,-0.004,0.000,0.000,0.000,
-0.253,0.003,-0.003,0.000,0.000,0.000,
-0.253,0.004,-0.004,0.000,0.000,0.000,
])

arr = arr.reshape((1, 128, 6))

# Load TFLite model and allocate tensors.
interpreter = tf.lite.Interpreter(model_path=os.path.join(MODEL_PATH, "350kb.tflite"))
interpreter.allocate_tensors()

# Get input and output tensors.
input_details = interpreter.get_input_details()
output_details = interpreter.get_output_details()

print(input_details)

# Test model on random input data.
input_shape = input_details[0]['shape']
interpreter.set_tensor(input_details[0]['index'], np.float32(arr))

interpreter.invoke()

# The function `get_tensor()` returns a copy of the tensor data.
# Use `tensor()` in order to get a pointer to the tensor.
output_data = interpreter.get_tensor(output_details[0]['index'])
print(output_data)